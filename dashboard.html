<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Deposit Money</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
  <style>
    #back {
      background-image: url("./img/light-blue.webp");
    }
   
  </style>
    <script src="./home.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<body id="back" >

    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top">
  <div class="container">
    <a class="navbar-brand d-flex align-items-center" href="#">
      <img src="./img/bank-icon-bank-and-business-sign-and-symbol-png.webp" alt="Logo" class="me-2" height="32">
      <span class="fw-bold text-primary">Nexa Bank</span>
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ul class="navbar-nav align-items-center">
        <li class="nav-item me-3">
          <a class="nav-link text-primary" href="./register.html"><i class="bi bi-person-plus me-1"></i> Register</a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-primary" href="./login.html"><i class="bi bi-box-arrow-in-right me-1"></i> Login</a>
        </li>
      </ul>
    </div>
  </div>
</nav> 


<div class="welcome">
  <h2 id="welcomeUser">Welcome</h2>
</div>
  
</div>



  <!-- ------------------------------Deposit Section ------------------------------------------------------------------>
  <section class="container py-45" style="margin-top: 80px; height: 50px; width: 50%;">
    <div class="row align-items-center shadow-lg rounded-3 p-4 bg-white" >
      
      <!-- Left Side Image -->
      <div class="col-md-6 text-center">
        <img src="./img/deposit.webp" 
             alt="Deposit Illustration" class="img-fluid rounded-3">
      </div>

      <!-- Right Side Form -->
      <div class="col-md-6">
        <h2 class="mb-4 text-warning">Deposit Money</h2>
        <form id="depositForm">
          <!-- Amount Input -->
          <div class="mb-3">
            <label for="amount" class="form-label">Enter Amount</label>
            <input type="text" class="form-control" id="amount" placeholder="Enter deposit amount" required>
          </div>
          
          <!-- Password Input -->
          <div class="mb-3">
            <label for="password" class="form-label">password</label>
            <input type="password" class="form-control" id="account" placeholder="Enter your password" required>
          </div>
          
          <!-- Deposit Button -->
          <button type="button" onclick="depositOn()" class="btn btn-warning w-100">Deposit</button>
        </form>

        <!-- Empty Div for Display -->
        <div id="depositResult" class="mt-4 p-3 border rounded bg-light text-success fw-bold"></div>
      </div>
    </div>
  </section>



  <!-- Withdraw + History Inline Section -->
  <section class="container pb-5" style="margin-top: 400px;">
    <div class="row g-5">
      
      <!-- Withdraw Section -->
      <div class="col-md-6">
        <div class="row align-items-center shadow-lg rounded-3 p-4 bg-white h-100">
          <!-- Image -->
          <div class="col-5 text-center">
            <img src="./img/3d-illustration-colorful-withdraw-money-png.webp" 
                 alt="Withdraw Illustration" class="img-fluid rounded-3">
          </div>
          <!-- Form -->
          <div class="col-7">
            <h3 class="text-warning mb-3">Withdraw Money</h3>
            <form id="withdrawForm">
              <div class="mb-3">
                <label for="withdrawAmount" class="form-label">Enter Amount</label>
                <input type="number" class="form-control" id="withdrawAmount" placeholder="Enter withdrawal amount" required>
              </div>
              <div class="mb-3">
                <label for="withdrawPassword" class="form-label">Enter Password</label>
                <input type="password" class="form-control" id="withdrawPassword" placeholder="Enter your password" required>
              </div>
              <button type="submit"   class="btn btn-warning w-100">Withdraw</button>
            </form>
            <div id="withdrawResult" class="mt-3 p-2 border rounded bg-light text-danger fw-bold"></div>
          </div>
        </div>
      </div>

      <!-- Transaction History Section -->
      <div class="col-md-6">
        <div class="row align-items-center shadow-lg rounded-3 p-4 bg-white h-100">
          <!-- Image -->
          <div class="col-5 text-center">
            <img src="./img/transaction-history_313674-11480.avif" 
                 alt="Transaction History" class="img-fluid rounded-3">
          </div>
          <!-- History -->
          <div class="col-7">
            <h3 class="text-warning mb-3">Transaction History</h3>
            <ul id="transactionHistory" class="list-group small"></ul>
          </div>
        </div>
      </div>
    </div>
  </section>





<script>
  // -------------------------- Deposit Function --------------------------
function depositOn() {
  const amountInput = document.getElementById("amount").value;
  const passwordInput = document.getElementById("account").value;
  const resultDiv = document.getElementById("depositResult");

  if (amountInput === "" || passwordInput === "") {
    resultDiv.innerHTML = " Please fill all fields";
    return;
  }

  const amount = parseFloat(amountInput);
  if (isNaN(amount) || amount <= 0) {
    resultDiv.innerHTML = " Enter a valid amount";
    return;
  }

  // Find account by password (since we don't have session)
  let found = false;
  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    const user = JSON.parse(localStorage.getItem(key));
    if (user.password === passwordInput) {
      user.balance += amount;
      // Save updated user
      localStorage.setItem(key, JSON.stringify(user));

      // Add transaction
      addTransaction(key, "Deposit", amount);

      resultDiv.innerHTML = ` Successfully deposited ₹${amount}. New balance: ₹${user.balance}`;
      found = true;
      break;
    }
  }

  if (!found) {
    resultDiv.innerHTML = " Password not matched!";
  }
}

// -------------------------- Withdraw Function --------------------------
document.getElementById("withdrawForm").addEventListener("submit", function (e) {
  e.preventDefault();

  const amount = parseFloat(document.getElementById("withdrawAmount").value);
  const password = document.getElementById("withdrawPassword").value;
  const resultDiv = document.getElementById("withdrawResult");

  if (isNaN(amount) || amount <= 0 || password === "") {
    resultDiv.innerHTML = "⚠️ Fill valid fields";
    return;
  }

  let found = false;
  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    const user = JSON.parse(localStorage.getItem(key));
    if (user.password === password) {
      if (user.balance >= amount) {
        user.balance -= amount;
        localStorage.setItem(key, JSON.stringify(user));

        addTransaction(key, "Withdraw", amount);

        resultDiv.innerHTML = ` Successfully withdrew ₹${amount}. New balance: ₹${user.balance}`;
      } else {
        resultDiv.innerHTML = " Insufficient balance!";
      }
      found = true;
      break;
    }
  }

  if (!found) {
    resultDiv.innerHTML = "Password not matched!";
  }
});

// -------------------------- Transaction Function --------------------------
function addTransaction(accountKey, type, amount) {
  let transactions = JSON.parse(localStorage.getItem("transactions")) || [];
  transactions.push({
    account: accountKey,
    type: type,
    amount: amount,
    date: new Date().toLocaleString()
  });
  localStorage.setItem("transactions", JSON.stringify(transactions));
  displayTransactions();
}

// -------------------------- Display Transactions --------------------------
function displayTransactions() {
  const list = document.getElementById("transactionHistory");
  list.innerHTML = "";
  const transactions = JSON.parse(localStorage.getItem("transactions")) || [];
  transactions.forEach(trx => {
    const li = document.createElement("li");
    li.className = "list-group-item";
    li.textContent = `${trx.date} - [${trx.account}] ${trx.type}: ₹${trx.amount}`;
    list.appendChild(li);
  });
}

// Call displayTransactions on page load
displayTransactions();

</script>






</body>
</html>

